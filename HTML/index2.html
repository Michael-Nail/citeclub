
<!DOCTYPE html>
<html>
	<head>
		<title>Cite Club</title>
	</head>
	<body>

		<script type="text/javascript" src="./js/vendor/jquery-1.8.2.min.js"></script>
		<script type="text/javascript" src="./js/citeclub.js"></script>
		<script type="text/javascript">
			$(document).ready(function() {
			
				var searchingMsg = "Searching for a page that needs your help...";
				$('#searching').html(searchingMsg);
			
				// hide iframe
				$('iframe#wikiPage, #recent').css('display','none');
				
				// add event handler to link
				$('#newPage').click(function() {
					$('#searching').html(searchingMsg);
					var keywords = $.trim($('#keywords').val());
					newPage(keywords);
				});
				
				// load page when selected
				$('#recentPages').change(function() {
					var selectedPageId = $('select#recentPages').val();
					$('iframe#wikiPage').attr('src', urlFromPageId(selectedPageId));
				});
				
				// get new page automatically
				$('#newPage').click();
			});
			
			function newPage(keywords) {
			
				/*
				* Gets new page URL, displays iframe (in case it's hidden), and sets iframe src to it
				*/
				
				// disable button while searching
				$('#newPage').prop('disabled', true);
			
				citationNeededPage(keywords, function(pageData) {
					var id = pageData.id;
					var title = pageData.title;
					// show 'page found'
					$('#searching').html('Page found!');
					// display iframe and recent 
					$('iframe#wikiPage, #recent').css('display','inline');
					// set iframe to page URL
					$('iframe#wikiPage').attr('src', urlFromPageId(id));
					// add page to dropdown
					$('select#recentPages')
						.append(
							$("<option></option>") // add new option
								.attr('value', id) // whose value is the id
								.text(title)	   // text is the title
						)
						.children('option:last').prop('selected', true); // select newly added option
					// enable button
					$('#newPage').prop('disabled', false);
				});
			}
		</script>
		
		<h2>Cite Club</h2>
		
		<p id="searching"></p>
		
		<p>
			<input type="button" id="newPage" value="new page" /> search by <input type="text" id="keywords" />
		</p>
		<p id="recent">
			Recent Articles: <select id="recentPages"></select>
		</p>
		<br/>
		<iframe name="wikiPage" id="wikiPage" width="768" height="1000"></iframe>
		
	</body>
</html>

